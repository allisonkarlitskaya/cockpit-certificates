.ct-listing-panel {
  &-head {
    background: linear-gradient(to top, 
      var(--pf-global--BorderColor--100) 0,
      var(--pf-global--BorderColor--100) 1px,
      transparent 1px
    );
    display: flex;
    align-items: end;

    .pf-c-nav {
      margin-left: var(--pf-global--spacer--xs);
    }

    .pf-c-nav__item {
      --pf-c-nav__tertiary-list-item--MarginRight: 0;
      cursor: pointer;
    }

    // For now, let's use tertiary until PF4 tab is reworked
    // meanwhile, let's force restyle the tertiary to look like the upcoming tabs.
    // See https://patternfly-next-pr-2757.surge.sh/documentation/core/components/tabs
    // Setting padding height to be 1/2, however for being embedded in the list.
    .pf-c-nav__tertiary-list {
      flex-wrap: wrap;

      .pf-c-nav__link {
        --pf-c-nav__tertiary-list-link--PaddingTop: var(--pf-global--spacer--sm);
        --pf-c-nav__tertiary-list-link--PaddingBottom: var(--pf-global--spacer--sm);
        --pf-c-nav__tertiary-list-link--PaddingLeft: var(--pf-global--spacer--md);
        --pf-c-nav__tertiary-list-link--PaddingRight: var(--pf-global--spacer--md);
        padding: var(--pf-global--spacer--sm) var(--pf-global--spacer--md);

        &:hover {
          --pf-c-nav__tertiary-list-link--Color: inherit;

          &::after {
            --pf-c-nav__tertiary-list-link--hover--after--BackgroundColor: var(--pf-global--BorderColor--light-100);
          }
        }
      }
    }

    .dropdown, .btn-group, .pf-c-button, input, select {
      margin-left: var(--pf-global--spacer--xs);
    }
  }

  // Support action buttons on the right
  &-actions {
    display: flex;
    flex: auto;
    justify-content: end;
    margin: var(--pf-global--spacer--sm) var(--pf-global--spacer--sm);
  }

  // Tabless mode, with just action buttons
  &-simplebody-actions {
    padding: var(--pf-global--spacer--xs) var(--pf-global--spacer--md) var(--pf-global--spacer--xs) 0;
    float: right;
  }

  &-body {
    padding: var(--pf-global--spacer--md) var(--pf-global--spacer--lg);
    width: 100%;

    // Containing hack part 1
    float: left;

    &::after {
      // Containing hack part 2: Clearfix CSS hack,
      // to allow children content to float fine without setting overflow
      content: "";
      clear: both;
      display: table;
    }
  }

  &-simplebody-actions + &-body {
    // Containing hack part 3: Unset float for simplebody actions
    float: none;
  }
}

.ct-table {
  tbody.pf-m-expanded {
    .ct-listing-panel-head {
      animation: ctListingPanelShow 100ms ease-in-out;

      + .ct-listing-panel-body:not([hidden]):last-child {
        animation: ctListingPanelShow 100ms ease-in-out;
      }
    }
  }

  > tbody > .pf-c-table__expandable-row {
    // Don't scroll table's expanded contents vertically.
    // Instead, rely on page scrolling.
    // Important for mobile; also useful for desktop.
    overflow-y: visible !important;
  }
}

@media (prefers-reduced-motion: reduce) {
  tbody.open {
    td.ct-listing-panel-toggle i:before {
      animation: none;
    }

    div {
      &.ct-listing-panel-head, &.ct-listing-panel-body {
        animation: none;
      }
    }
  }
}

@keyframes ctListingPanelShow {
    0% {
        margin-bottom: 0;
        margin-top: 0;
        max-height: 0;
        opacity: 0;
        padding-bottom: 0;
        padding-top: 0;
        line-height: 0;
    } 50% {
        opacity: 0;
        line-height: 1;
    }
    100% {
        max-height: 100vh;
        opacity: 1;
    }
}

@keyframes ctListingPanelToggleOpen {
    0% {
       transform-origin: 50% 50%;
       transform: translate(0, -1px) rotate(-90deg);
    }
    100% {
       transform: translate(0, 0) rotate(0);
    }
}